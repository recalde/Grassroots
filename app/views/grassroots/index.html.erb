<div id="grass-body">
</div>  

<script id="topicsTemplate" type="text/x-jquery-tmpl">
<div id="tabs">
	<ul>
	<li><a href="#category-top">Top Ideas</a></li>
	<li><a href="#category-new">New Ideas</a></li>
    {{each topics}}
        <li><a href="#category-${id}">${name}</a></li>
    {{/each}}
	</ul>
	<div id="category-top" class="topic" category_type="top"></div>
	<div id="category-new" class="topic" category_type="new"></div>
	{{each topics}}
	    <div id="category-${id}" class="topic" category_id="${id}"></div>
	{{/each}}
</div>
</script>

<script id="ideaTemplate" type="text/x-jquery-tmpl">
<div class="idea ui-corner-all">
	<div class="idea-vote ui-corner-all">
		<div class="vote-count">${vote_tally}</div>
		<div class="vote-yea">Yea</div>
		<div class="vote-nay">Nay</div>
	</div>
	<div class="idea-body">
		<div class="idea-subject">
			<a href="/ideas/${seo_url}">${subject}</a>
		</div>
		<div class="idea-text">
			${description}
		</div>
		<div class="idea-user">
			Posted by ${user_alias} to ${category_name} (${prettyDate($data.created_at)})
		</div>
	</div>
	<div class="idea-clear" />
</div>
</script>

<script id="newIdeaDialogTemplate" type="text/x-jquery-tmpl">
<div>
	<div class="dialog-input">
		Subject:<br/>
		<input id="new_idea_subject" type="text" /> 
	</div>
	<div class="dialog-input">
		Description:<br/>
		<textarea id="new_idea_description" cols="50" rows="5"></textarea>
	</div>
	{{if category_id}}
		<input id="new_idea_category_id" type="hidden" value="${category_id}" />
	{{else}}
		<div class="dialog-input">
		Category:<br/>
		<select id="new_idea_category_id" class="ui-widget ui-corner-all">
		{{each categories}}
			<option value="${id}">${name}</option>
		{{/each}}
		</select>
		</div>
	{{/if}}
</div>
</script>

<script>
	
	$(function () { 

		<% if user_signed_in? %>
		
		$('.vote-yea').live('click', function() {
			var tmplItem = $(this).tmplItem();
			vote(tmplItem.data.id, 'yae', function(data) {
				tmplItem.data.vote_tally = data.vote_tally;
				tmplItem.update();
			});
		});
		
		$('.vote-nay').live('click', function(){
			var tmplItem = $(this).tmplItem();
			vote(tmplItem.data.id, 'nay', function(data) {
				tmplItem.data.vote_tally = data.vote_tally;
				tmplItem.update();
			});
		});

		$('.new-idea').live('click', new_idea);
		
		<% else %>
		$('.vote-yea').live('click', login_dialog);
		$('.vote-nay').live('click', login_dialog);
		$('.new-idea').live('click', login_dialog);
		<% end %>

		renderCategories();
		
	});
	
</script>